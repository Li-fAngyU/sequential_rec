Namespace(adam_beta1=0.9, adam_beta2=0.999, aggregation='mean', attention_probs_dropout_prob=0.5, attribute_size=638, batch_size=256, checkpoint_path='output/introduction/Finetune_sample-Beauty-0-TOP1-max-100.pt', ckp=0, cuda_condition=True, data_dir='./data/', data_file='./data/Beauty.txt', data_name='Beauty', do_eval=False, epochs=200, gpu_id='1', hidden_act='gelu', hidden_dropout_prob=0.5, hidden_size=64, initializer_range=0.02, isfull=0, item2attribute=None, item_size=12103, log_file='output/introduction/Finetune_sample-Beauty-0-TOP1-max-100.txt', log_freq=1, loss_type='TOP1-max', lr=0.001, mask_id=12102, mask_prod=0.2, max_seq_length=50, model_name='Finetune_sample', no_cuda=False, num_attention_heads=2, num_hidden_layers=2, output_dir='output/introduction/', rank_act='softmax', sample_file='./data/Beauty_sample.txt', sample_num=100, seed=42, train_matrix=<22363x12103 sparse matrix of type '<class 'numpy.int64'>'
	with 176139 stored elements in Compressed Sparse Row format>, weight_decay=0.0)
{'epoch': 0, 'rec_avg_loss': '0.00795908', 'rec_cur_loss': '0.00744464', 'total training time': '3.0500', 'max mem': '285'}
{'epoch': 1, 'rec_avg_loss': '0.00636075', 'rec_cur_loss': '0.00608838', 'total training time': '5.9091', 'max mem': '285'}
{'epoch': 2, 'rec_avg_loss': '0.00531438', 'rec_cur_loss': '0.00584514', 'total training time': '9.0564', 'max mem': '285'}
{'epoch': 3, 'rec_avg_loss': '0.00486120', 'rec_cur_loss': '0.00499791', 'total training time': '11.9829', 'max mem': '285'}
{'epoch': 4, 'rec_avg_loss': '0.00465622', 'rec_cur_loss': '0.00472955', 'total training time': '15.2565', 'max mem': '285'}
{'epoch': 5, 'rec_avg_loss': '0.00453397', 'rec_cur_loss': '0.00551142', 'total training time': '18.0625', 'max mem': '285'}
{'epoch': 6, 'rec_avg_loss': '0.00443643', 'rec_cur_loss': '0.00479020', 'total training time': '20.9723', 'max mem': '285'}
{'epoch': 7, 'rec_avg_loss': '0.00437717', 'rec_cur_loss': '0.00439951', 'total training time': '24.0313', 'max mem': '285'}
{'epoch': 8, 'rec_avg_loss': '0.00433173', 'rec_cur_loss': '0.00501315', 'total training time': '26.9969', 'max mem': '285'}
{'epoch': 9, 'rec_avg_loss': '0.00431229', 'rec_cur_loss': '0.00503147', 'total training time': '30.0743', 'max mem': '285'}
{'epoch': 10, 'rec_avg_loss': '0.00426236', 'rec_cur_loss': '0.00436610', 'total training time': '33.1101', 'max mem': '285'}
{'epoch': 11, 'rec_avg_loss': '0.00427086', 'rec_cur_loss': '0.00493009', 'total training time': '36.2422', 'max mem': '285'}
{'epoch': 12, 'rec_avg_loss': '0.00424723', 'rec_cur_loss': '0.00491477', 'total training time': '39.1365', 'max mem': '285'}
{'epoch': 13, 'rec_avg_loss': '0.00423127', 'rec_cur_loss': '0.00436430', 'total training time': '42.2554', 'max mem': '285'}
{'epoch': 14, 'rec_avg_loss': '0.00422199', 'rec_cur_loss': '0.00453103', 'total training time': '45.2656', 'max mem': '285'}
{'epoch': 15, 'rec_avg_loss': '0.00421812', 'rec_cur_loss': '0.00408127', 'total training time': '48.5597', 'max mem': '285'}
{'epoch': 16, 'rec_avg_loss': '0.00418492', 'rec_cur_loss': '0.00429435', 'total training time': '51.6470', 'max mem': '285'}
{'epoch': 17, 'rec_avg_loss': '0.00418723', 'rec_cur_loss': '0.00436631', 'total training time': '54.8374', 'max mem': '285'}
{'epoch': 18, 'rec_avg_loss': '0.00416510', 'rec_cur_loss': '0.00372941', 'total training time': '57.8567', 'max mem': '285'}
{'epoch': 19, 'rec_avg_loss': '0.00414584', 'rec_cur_loss': '0.00406782', 'total training time': '60.9847', 'max mem': '285'}
{'epoch': 20, 'rec_avg_loss': '0.00414776', 'rec_cur_loss': '0.00470444', 'total training time': '64.1449', 'max mem': '285'}
{'epoch': 21, 'rec_avg_loss': '0.00413996', 'rec_cur_loss': '0.00383267', 'total training time': '67.3038', 'max mem': '285'}
{'epoch': 22, 'rec_avg_loss': '0.00415927', 'rec_cur_loss': '0.00407244', 'total training time': '70.2056', 'max mem': '285'}
{'epoch': 23, 'rec_avg_loss': '0.00411439', 'rec_cur_loss': '0.00446413', 'total training time': '73.3549', 'max mem': '285'}
{'epoch': 24, 'rec_avg_loss': '0.00412349', 'rec_cur_loss': '0.00450885', 'total training time': '76.3876', 'max mem': '285'}
{'epoch': 25, 'rec_avg_loss': '0.00411923', 'rec_cur_loss': '0.00472214', 'total training time': '79.3561', 'max mem': '285'}
{'epoch': 26, 'rec_avg_loss': '0.00407435', 'rec_cur_loss': '0.00480501', 'total training time': '82.2785', 'max mem': '285'}
{'epoch': 27, 'rec_avg_loss': '0.00412683', 'rec_cur_loss': '0.00426676', 'total training time': '85.2244', 'max mem': '285'}
{'epoch': 28, 'rec_avg_loss': '0.00409883', 'rec_cur_loss': '0.00363904', 'total training time': '88.4812', 'max mem': '285'}
{'epoch': 29, 'rec_avg_loss': '0.00407051', 'rec_cur_loss': '0.00440937', 'total training time': '91.6229', 'max mem': '285'}
{'epoch': 30, 'rec_avg_loss': '0.00409169', 'rec_cur_loss': '0.00407729', 'total training time': '94.6092', 'max mem': '285'}
{'epoch': 31, 'rec_avg_loss': '0.00408745', 'rec_cur_loss': '0.00468083', 'total training time': '97.4427', 'max mem': '285'}
{'epoch': 32, 'rec_avg_loss': '0.00410315', 'rec_cur_loss': '0.00394000', 'total training time': '100.6165', 'max mem': '285'}
{'epoch': 33, 'rec_avg_loss': '0.00408193', 'rec_cur_loss': '0.00465042', 'total training time': '103.5136', 'max mem': '285'}
{'epoch': 34, 'rec_avg_loss': '0.00406496', 'rec_cur_loss': '0.00417190', 'total training time': '106.7352', 'max mem': '285'}
{'epoch': 35, 'rec_avg_loss': '0.00405804', 'rec_cur_loss': '0.00361491', 'total training time': '109.5845', 'max mem': '285'}
{'epoch': 36, 'rec_avg_loss': '0.00405856', 'rec_cur_loss': '0.00384921', 'total training time': '112.7263', 'max mem': '285'}
{'epoch': 37, 'rec_avg_loss': '0.00402868', 'rec_cur_loss': '0.00419228', 'total training time': '115.6891', 'max mem': '285'}
{'epoch': 38, 'rec_avg_loss': '0.00403367', 'rec_cur_loss': '0.00423218', 'total training time': '118.8536', 'max mem': '285'}
{'epoch': 39, 'rec_avg_loss': '0.00404988', 'rec_cur_loss': '0.00446469', 'total training time': '121.7429', 'max mem': '285'}
{'epoch': 40, 'rec_avg_loss': '0.00402905', 'rec_cur_loss': '0.00347433', 'total training time': '124.6815', 'max mem': '285'}
{'epoch': 41, 'rec_avg_loss': '0.00402385', 'rec_cur_loss': '0.00415445', 'total training time': '127.7078', 'max mem': '285'}
{'epoch': 42, 'rec_avg_loss': '0.00401985', 'rec_cur_loss': '0.00423803', 'total training time': '130.6084', 'max mem': '285'}
{'epoch': 43, 'rec_avg_loss': '0.00401913', 'rec_cur_loss': '0.00438008', 'total training time': '133.7251', 'max mem': '285'}
{'epoch': 44, 'rec_avg_loss': '0.00400703', 'rec_cur_loss': '0.00442510', 'total training time': '136.8403', 'max mem': '285'}
{'epoch': 45, 'rec_avg_loss': '0.00399404', 'rec_cur_loss': '0.00432103', 'total training time': '139.7855', 'max mem': '285'}
{'epoch': 46, 'rec_avg_loss': '0.00401442', 'rec_cur_loss': '0.00391633', 'total training time': '143.1671', 'max mem': '285'}
{'epoch': 47, 'rec_avg_loss': '0.00399067', 'rec_cur_loss': '0.00399732', 'total training time': '146.0814', 'max mem': '285'}
{'epoch': 48, 'rec_avg_loss': '0.00400960', 'rec_cur_loss': '0.00435614', 'total training time': '148.9555', 'max mem': '285'}
{'epoch': 49, 'rec_avg_loss': '0.00397465', 'rec_cur_loss': '0.00398922', 'total training time': '152.1093', 'max mem': '285'}
{'epoch': 50, 'rec_avg_loss': '0.00398308', 'rec_cur_loss': '0.00411342', 'total training time': '155.0809', 'max mem': '285'}
{'epoch': 51, 'rec_avg_loss': '0.00399304', 'rec_cur_loss': '0.00411421', 'total training time': '158.0512', 'max mem': '285'}
{'epoch': 52, 'rec_avg_loss': '0.00399692', 'rec_cur_loss': '0.00404212', 'total training time': '161.0484', 'max mem': '285'}
{'epoch': 53, 'rec_avg_loss': '0.00397226', 'rec_cur_loss': '0.00411012', 'total training time': '164.0513', 'max mem': '285'}
{'epoch': 54, 'rec_avg_loss': '0.00399986', 'rec_cur_loss': '0.00371117', 'total training time': '167.5060', 'max mem': '285'}
{'epoch': 55, 'rec_avg_loss': '0.00397257', 'rec_cur_loss': '0.00445222', 'total training time': '170.4681', 'max mem': '285'}
{'epoch': 56, 'rec_avg_loss': '0.00398125', 'rec_cur_loss': '0.00383736', 'total training time': '173.6432', 'max mem': '285'}
{'epoch': 57, 'rec_avg_loss': '0.00396923', 'rec_cur_loss': '0.00419705', 'total training time': '176.7442', 'max mem': '285'}
{'epoch': 58, 'rec_avg_loss': '0.00402933', 'rec_cur_loss': '0.00380764', 'total training time': '179.7155', 'max mem': '285'}
{'epoch': 59, 'rec_avg_loss': '0.00398982', 'rec_cur_loss': '0.00425836', 'total training time': '182.6954', 'max mem': '285'}
{'epoch': 60, 'rec_avg_loss': '0.00399648', 'rec_cur_loss': '0.00409680', 'total training time': '185.6713', 'max mem': '285'}
{'epoch': 61, 'rec_avg_loss': '0.00395641', 'rec_cur_loss': '0.00402685', 'total training time': '188.7014', 'max mem': '285'}
{'epoch': 62, 'rec_avg_loss': '0.00399570', 'rec_cur_loss': '0.00391094', 'total training time': '191.5443', 'max mem': '285'}
{'epoch': 63, 'rec_avg_loss': '0.00397064', 'rec_cur_loss': '0.00426032', 'total training time': '194.6374', 'max mem': '285'}
{'epoch': 64, 'rec_avg_loss': '0.00398721', 'rec_cur_loss': '0.00430656', 'total training time': '198.0134', 'max mem': '285'}
{'epoch': 65, 'rec_avg_loss': '0.00398540', 'rec_cur_loss': '0.00430252', 'total training time': '200.7952', 'max mem': '285'}
{'epoch': 66, 'rec_avg_loss': '0.00397837', 'rec_cur_loss': '0.00378715', 'total training time': '203.9352', 'max mem': '285'}
{'epoch': 67, 'rec_avg_loss': '0.00398780', 'rec_cur_loss': '0.00407898', 'total training time': '206.8695', 'max mem': '285'}
{'epoch': 68, 'rec_avg_loss': '0.00398866', 'rec_cur_loss': '0.00437691', 'total training time': '209.8004', 'max mem': '285'}
{'epoch': 69, 'rec_avg_loss': '0.00397343', 'rec_cur_loss': '0.00339921', 'total training time': '212.9512', 'max mem': '285'}
{'epoch': 70, 'rec_avg_loss': '0.00398018', 'rec_cur_loss': '0.00397946', 'total training time': '215.9394', 'max mem': '285'}
{'epoch': 71, 'rec_avg_loss': '0.00396353', 'rec_cur_loss': '0.00465663', 'total training time': '219.0496', 'max mem': '285'}
{'epoch': 72, 'rec_avg_loss': '0.00395328', 'rec_cur_loss': '0.00404213', 'total training time': '222.3557', 'max mem': '285'}
{'epoch': 73, 'rec_avg_loss': '0.00397319', 'rec_cur_loss': '0.00426041', 'total training time': '225.3103', 'max mem': '285'}
{'epoch': 74, 'rec_avg_loss': '0.00394458', 'rec_cur_loss': '0.00407095', 'total training time': '228.6750', 'max mem': '285'}
{'epoch': 75, 'rec_avg_loss': '0.00395182', 'rec_cur_loss': '0.00361289', 'total training time': '231.7309', 'max mem': '285'}
{'epoch': 76, 'rec_avg_loss': '0.00395548', 'rec_cur_loss': '0.00364507', 'total training time': '233.8130', 'max mem': '285'}
{'epoch': 77, 'rec_avg_loss': '0.00396349', 'rec_cur_loss': '0.00327925', 'total training time': '235.9739', 'max mem': '285'}
{'epoch': 78, 'rec_avg_loss': '0.00398076', 'rec_cur_loss': '0.00410428', 'total training time': '238.0571', 'max mem': '285'}
{'epoch': 79, 'rec_avg_loss': '0.00395799', 'rec_cur_loss': '0.00421740', 'total training time': '240.2497', 'max mem': '285'}
{'epoch': 80, 'rec_avg_loss': '0.00393812', 'rec_cur_loss': '0.00405858', 'total training time': '242.5029', 'max mem': '285'}
{'epoch': 81, 'rec_avg_loss': '0.00396239', 'rec_cur_loss': '0.00469646', 'total training time': '244.6910', 'max mem': '285'}
{'epoch': 82, 'rec_avg_loss': '0.00396497', 'rec_cur_loss': '0.00400745', 'total training time': '246.9785', 'max mem': '285'}
{'epoch': 83, 'rec_avg_loss': '0.00392658', 'rec_cur_loss': '0.00410468', 'total training time': '249.3261', 'max mem': '285'}
{'epoch': 84, 'rec_avg_loss': '0.00395241', 'rec_cur_loss': '0.00414785', 'total training time': '251.4781', 'max mem': '285'}
{'epoch': 85, 'rec_avg_loss': '0.00395411', 'rec_cur_loss': '0.00411874', 'total training time': '253.7329', 'max mem': '285'}
{'epoch': 86, 'rec_avg_loss': '0.00393057', 'rec_cur_loss': '0.00351804', 'total training time': '255.7824', 'max mem': '285'}
{'epoch': 87, 'rec_avg_loss': '0.00393192', 'rec_cur_loss': '0.00370214', 'total training time': '258.2478', 'max mem': '285'}
{'epoch': 88, 'rec_avg_loss': '0.00395624', 'rec_cur_loss': '0.00475753', 'total training time': '260.2898', 'max mem': '285'}
{'epoch': 89, 'rec_avg_loss': '0.00397636', 'rec_cur_loss': '0.00385423', 'total training time': '262.0706', 'max mem': '285'}
{'epoch': 90, 'rec_avg_loss': '0.00395399', 'rec_cur_loss': '0.00457812', 'total training time': '263.4191', 'max mem': '285'}
{'epoch': 91, 'rec_avg_loss': '0.00394918', 'rec_cur_loss': '0.00386416', 'total training time': '264.7976', 'max mem': '285'}
{'epoch': 92, 'rec_avg_loss': '0.00395537', 'rec_cur_loss': '0.00444097', 'total training time': '266.1801', 'max mem': '285'}
{'epoch': 93, 'rec_avg_loss': '0.00394842', 'rec_cur_loss': '0.00457164', 'total training time': '267.5347', 'max mem': '285'}
{'epoch': 94, 'rec_avg_loss': '0.00395381', 'rec_cur_loss': '0.00438565', 'total training time': '268.8422', 'max mem': '285'}
{'epoch': 95, 'rec_avg_loss': '0.00396802', 'rec_cur_loss': '0.00381747', 'total training time': '270.0794', 'max mem': '285'}
{'epoch': 96, 'rec_avg_loss': '0.00392852', 'rec_cur_loss': '0.00412296', 'total training time': '271.3302', 'max mem': '285'}
{'epoch': 97, 'rec_avg_loss': '0.00396714', 'rec_cur_loss': '0.00397842', 'total training time': '272.6074', 'max mem': '285'}
{'epoch': 98, 'rec_avg_loss': '0.00397306', 'rec_cur_loss': '0.00444128', 'total training time': '273.8976', 'max mem': '285'}
{'epoch': 99, 'rec_avg_loss': '0.00395108', 'rec_cur_loss': '0.00426741', 'total training time': '275.1561', 'max mem': '285'}
{'epoch': 100, 'rec_avg_loss': '0.00397547', 'rec_cur_loss': '0.00382944', 'total training time': '276.4638', 'max mem': '285'}
{'epoch': 101, 'rec_avg_loss': '0.00395325', 'rec_cur_loss': '0.00380701', 'total training time': '277.7073', 'max mem': '285'}
{'epoch': 102, 'rec_avg_loss': '0.00396567', 'rec_cur_loss': '0.00449685', 'total training time': '278.9831', 'max mem': '285'}
{'epoch': 103, 'rec_avg_loss': '0.00394164', 'rec_cur_loss': '0.00385214', 'total training time': '280.2271', 'max mem': '285'}
{'Epoch': 0, 'HIT@5': '0.0093', 'NDCG@5': '0.0058', 'HIT@10': '0.0148', 'NDCG@10': '0.0076', 'HIT@20': '0.0270', 'NDCG@20': '0.0107'}
{'Epoch': 0, 'HIT@1': '0.0000', 'NDCG@1': '0.0000', 'HIT@5': '0.0000', 'NDCG@5': '0.0000', 'HIT@10': '0.0005', 'NDCG@10': '0.0001', 'MRR': '0.0663'}
Finetune_sample-Beauty-0-TOP1-max-100
{'Epoch': 0, 'HIT@1': '0.0000', 'NDCG@1': '0.0000', 'HIT@5': '0.0000', 'NDCG@5': '0.0000', 'HIT@10': '0.0005', 'NDCG@10': '0.0001', 'MRR': '0.0663'}
{'Epoch': 0, 'HIT@5': '0.0093', 'NDCG@5': '0.0058', 'HIT@10': '0.0148', 'NDCG@10': '0.0076', 'HIT@20': '0.0270', 'NDCG@20': '0.0107'}
